[0009] In addition, the parsing process is likely to alter the HTML in ways other than simply adding the additional data. For example, parsing and reconstruction of the HTML code may reduce (or increase) whitespace, change a font or font size, change case (e.g., uppercase to lowercase or vice versa) and/or make other alterations. Even a subtle change in the HTML may cause an application that operates on the code to act differently or to present the HTML differently to a user.
[0010] In addition, an HTML parser (or a parser that operates on other markup language) expects to receive well-formed code, and may not be able to handle code that contains even a minor error. An error in a page of HTML content may cause the parser to operate incorrectly or to fail to operate on the content, thereby preventing a user from receiving the content or from initiating a follow-on request (e.g., because the additional data could not be inserted as required).
[0011] Thus, this method of protecting against a CSRF may cause changes in a legitimate user's experience, or may even cause content to be presented incorrectly or not be presented at all.
[0012] In some embodiments of the invention, methods and apparatus are provided for protecting against cross-site request forgeries (CSRFs), by requiring certain requests submitted to a computer server to include specific tokens.
[0013] In these embodiments, the requests involve modification of or access to protected data, and the required tokens are inserted into content from which the requests are initiated. For example, content that includes a form, a hyperlink, a scripted request or other control for initiating a follow-on request to the server may be modified to include tokens for each control that may cause a follow-on request.