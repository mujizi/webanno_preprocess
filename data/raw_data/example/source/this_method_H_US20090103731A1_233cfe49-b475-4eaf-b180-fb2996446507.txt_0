[0018] The IEEE 802.15.4 standard defines wireless personal area networks (WPANs) for small, inexpensive, power-efficient, short-range wireless devices. The main objectives of a low rate WPAN are ease of installation with little infrastructure, reliable data transfer, short-range operation, and extremely low cost and reasonable battery life, while maintaining a simple and flexible protocol. The IEEE 802.15.4 standard identifies a number of security suites for data confidentiality, data authenticity, and replay protection, but does not define the processes of key exchange and authentication, which is left to be addressed by the higher layers of the WPAN communications architecture.
[0019] The ZigBee specification defines a security architecture for the IEEE 802.15.4 networks, which splits the security functionalities into three layers: a medium access control (MAC) layer, a network (NWK) layer, and an application (APS) layer. The MAC layer is defined by IEEE 802.15.4. The main responsibilities of the NWK layer include the mechanisms used to join and leave a network, apply security to frames and to route frames to their intended destinations. The APS layer is responsible for the establishment and maintenance of security relationships. The ZigBee security architecture uses a trust center for device authentication and key management. Each device receives the initial master key or network key from the trust center via unsecured key transport. Subsequent master key, network key, and link keys are obtained from the trust center via secured key transport. Since the master key is used as the long-term security between two devices and is not protected cryptographically, it results in a security flaw.
[0020] Herein a new authentication method is disclosed that authenticates the IEEE 802.15.4 based sensor devices using a lightweight EAP authentication method EAP-GPSK. According to this method, the sensors of the WPAN have a pre-shared key also known to an authentication server used in association with a novel EAP encapsulation messaging system and method. The EAP packets are encapsulated in IEEE 802.15.4 frames. A 3-party architecture is disclosed that includes a PAN coordinator as the authenticator, the sensor device as the peer, and the AAA server as the authentication server. A novel security application protocol (SAP) messaging method to share and authenticate security keys between the sensor device or peer and the PAN coordinator is also described.
[0021] FIG. 1 illustrates an embodiment of a wireless communication system 100. The wireless communications system 100 may include a plurality of devices 102 in wireless communication with a PAN coordinator 104. The PAN coordinator 104 may communicate with an authentication server (AS) 108 using a wired or a wireless connection. The AS 108 may be located in a different network, such as the Internet 106. As shown in FIG. 1, the devices 102 and the PAN coordinator 104 may be configured in a single-hop WPAN topology such that each device 102 communicates directly with the PAN coordinator 104. Such an embodiment may be configured as described in IEEE standard 802.15.4, entitled "Wireless Medium Access Control (AC) and Physical Layer (PHY) Specifications for Low-Rate Wireless Personal Area Networks (WPANs)", which is incorporated herein by reference as if reproduced in its entirety. Such an embodiment may also transport internet protocol version 6 (IPv6) packets between each device 102 and the PAN coordinator 104 as described in IETF RFC 4944 by Montenegro et al. and entitled "Transmission of IPv6 Packets over IEEE 802.15.4 Networks", which is incorporated herein by reference as if reproduced in its entirety. In an embodiment, the system 100 employs Internet protocol version 6 (IPv6) addressing and the devices 102 and the PAN coordinator 104 may be referred to as a 6LoWPAN network, indicating that these devices use IPv6 over Low power Wireless Personal Area Network.
[0022] The devices 102 may be any devices that access or communicate, directly or indirectly, with the PAN coordinator 104. For example, the device 102 may be a wireless sensor that measures a property and communicates the property to the PAN coordinator 104. The devices 102 may be IPv6-enabled and may implement an IP stack. Specifically, when the devices 102 need to send IPv6 packets to the Internet 106, they may encapsulate the packets in IEEE 802.15.4 frames and send the frames to the PAN coordinator 104. Examples of properties measured by the devices 102 include temperature, pressure, motion, position, concentration, and so forth. Typically, the devices 102 are small autonomous devices whose processing ability is limited to the measurement and communications functions described herein. In an embodiment, some of the devices 102 sense consumption of public utility resources, for example electricity consumption, natural gas consumption, water consumption, and others. However, the devices 102 may also include portable computers, such as laptop, notebook, and tablet computers, cellular telephones, personal digital assistants (PDAs), and other mobile communication or computing systems. Alternatively, the device 102 may be any other type of computer or communication device known to persons of ordinary skill in the art. Each of the devices 102 is configured with a unique pre-shared key (PSK) to promote authentication functions that will be discussed further hereinafter.