[0039] FIG. 3A is an exemplary graph that illustrates proximity count versus distance for the optical sensor 102 of FIG. 1, which does not include the offset compensation according to embodiments of the present invention. The proximity count represents an output of the ADC 116. The offset shown in FIG. 3A adversely affects (i.e., reduces) the useful range of the optical sensor. The extent of the offset is dependent on the extent of the interference light. For example, the offset would most likely be largest if a barrier (e.g., 110) between the light source and light detector was not present. FIG. 3B is an exemplary graph that illustrates proximity count versus distance for an optical sensor that includes the analog offset compensation (e.g., one of the optical sensors 202a-202d) according to an embodiment of the present invention. In FIG. 3B the proximity count represents an output of the ADC 216 or 276. Notice how in FIG. 3B the usable range of the optical sensor is increased, as is the detection distance, as compared to FIG. 3A. As mentioned above, in certain embodiments, rather than completely removing the offset, as shown in FIG. 3B, embodiments of the present invention can be used to reduce the offset to a predetermined amount (e.g., a target offset).
[0040] Since proximity sensors are meant to operate in a user environment that includes ambient light, such sensors should preferably be able to detect weak signals (for lower power operation and/or for longer distance detection) even in the presence of strong ambient light. However, the photo current generated by ambient light in such sensors often overwhelm the sensors. This results in sensors that may be prone to falsely trigger, or not trigger when the should, due to strong ambient light interference.
[0041] Some conventional techniques for attempting to reject ambient light use a preamplifier amplifier with a high-pass resistance-capacitance (RC) network provided at an input of the preamplifier, to pass the high frequency components of a signal while blocking the low frequency components. However, this solution has two major drawbacks. First, a very large resistor and a very large capacitor are required to achieve the low cutoff frequency, which is undesirable because such passive components occupy a very large chip area and are sensitive to parasitic-coupled noise. Second, the voltage across the resistor varies with the average photo current, which causes the preamplifier's common-input (and therefore the overall performance) to be directly affected by the ambient light level. Another technique that has been used includes an active feedback loop around the preamplifier. In this configuration, the ambient light rejection is achieved by using analog level detection based on the peaks of the photo current signal. However, this technique assumes that the average current is constant, requires a reset mechanism and has a very low speed operation.
[0042] In accordance with specific embodiments of the present invention, in order to reject ambient light, the ADC 216 includes an analog-to-digital-to-analog (ADA) conversion feedback loop. Details of such an ADC will now be described with reference to FIGS. 4 and 5.
[0043] Referring to FIG. 4, an ADC 416 with feedback is shown, which can be used to implement the ADC 216 shown in FIGS. 2A-2C. The ADC 416 includes an N-bit forward path including an N-bit ADC 414. The ADC 416 also includes an M-bit feedback loop used to reject ambient light via direct photodiode current processing. The feedback loop includes an M-bit ADC 424 and an M-bit DAC 430. The feedback loop may be referred to as an ADA feedback loop, because it includes an analog-to-digital-to-analog (ADA) conversion. Thus, the ADC 416 can be referred to as an ADC with ADA feedback. The output of the N-bit ADC 414 of the forward path provides the N-bit output of the ADC 416, which can be the N-bit output of ADC 216 in FIGS. 2A-2C. In accordance with an embodiment of the present invention M<N (e.g., M=7 and N=8). However, it is also within the scope of the present invention that M=N, or that M>N. As will be appreciated from the description herein, the N-bit ADC with the M-bit ADA feedback loop is used to reject ambient light and increase the dynamic range and sensitivity of proximity sensing. Some of the advantages of using the ADA feedback loop, over using an analog feedback loop, includes higher speed/faster operation, smaller silicon size, and lower noise.