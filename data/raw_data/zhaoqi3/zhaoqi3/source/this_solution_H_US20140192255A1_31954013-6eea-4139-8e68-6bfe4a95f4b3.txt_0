[0061] FIGS. 9-10 illustrate this concept. In this example, the filter module 110 has two bandpass wavelength filters. Filter F1 is centered at 450 nm and filter F2 is centered at 650 nm. FIG. 9A shows the subarray 133 when only filter F1 is used. The corresponding image of a petal is shown in FIG. 10A. Note that there are spots on the surface. FIG. 9B shows the subarray 133 when only filter F2 is used. The corresponding image of a petal is shown in FIG. 10B. Note that there are rings on the petal surface. FIG. 9C shows the subarray 133 when both filters F1 and F2 are used, but they are used in equal proportion. That is, filter F1 occupies 50% of the pupil and filter F2 occupies the other 50%. The resulting multimode image is shown in FIG. 10C. Note that the rings at 650 nm are visible but the spots at 450 nm are not. This is because the 450 nm component requires longer exposure or stronger illumination. However, just increasing the exposure could overexpose the 650 nm component.
[0062] FIGS. 9D and 10D show a solution. The filter module is positioned so that the 450 nm filter F2 occupies more of the pupil area, as shown in FIG. 9D. The exposure condition is also adjusted so that components from both filters F1 and F2 receive the correct exposure. In this example, the sum of the photons collected at all detectors behind each filter is optimized. Care is taken to adjust the exposure/light power versus the filter area such that the detectors behind each filter is not saturated. The resulting multimode image is shown in FIG. 10D. Both the 450 nm spots and the 650 nm rings are visible.
[0063] FIG. 11 is a flow diagram of this solution. The filter module begins at some initial position 1110. For example, it may be positioned so that different filters cover the same pupil area. With the filter module in this position, a multimode image is captured 1120 and processed 1130. The processed image is used to calculate 1140 an image quality metric. Examples of image quality metric include SNR, signal energy, contrast, brightness and exposure value. If the quality is not sufficient 1150, then the position of the filter module and the exposure condition are adjusted 1160. This is repeated until sufficient quality is obtained. The resulting settings may be store 1170.
[0064] The multimode image can be processed 1130 in many ways, which may affect the image quality metric 1140. For example, the processed image could be produced by summing or averaging all the detectors corresponding to each filter. Alternately, several sub-images for one filter could be produced by demultiplexing the detectors behind a lenslet into one sub-image. If the second method is chosen, then further processing might be applied to better define the image quality metric. This additional processing could be averaging all the sub-images for a given filter, or choosing features that are best in each sub-image to define a "sharpest feature" image, a "highest SNR" image, etc.
[0065] The following is another example method for determining the exposure condition corresponding to the position for the filter module. Let Q be the image quality metric. Assume there are K filters f.sub.k. In this example, there is an initial calibration (steps 1 and 2) before taking a sequence of images.