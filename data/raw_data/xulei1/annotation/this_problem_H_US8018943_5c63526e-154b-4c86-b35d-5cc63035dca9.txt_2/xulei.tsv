#FORMAT=WebAnno TSV 3.2
#T_SP=webanno.custom.Diy_coref|
#T_RL=webanno.custom.Diy_coref_re|BT_webanno.custom.Diy_coref


#Text=Users expect that accurate statistics will be maintained for each user-defined filter, including counts for the number of data packets and/or the total number of bytes that match each filter's criteria.
1-1	0-5	Users	_	_	
1-2	6-12	expect	_	_	
1-3	13-17	that	_	_	
1-4	18-26	accurate	_	_	
1-5	27-37	statistics	_	_	
1-6	38-42	will	_	_	
1-7	43-45	be	_	_	
1-8	46-56	maintained	_	_	
1-9	57-60	for	_	_	
1-10	61-65	each	_	_	
1-11	66-78	user-defined	_	_	
1-12	79-85	filter	_	_	
1-13	85-86	,	_	_	
1-14	87-96	including	_	_	
1-15	97-103	counts	_	_	
1-16	104-107	for	_	_	
1-17	108-111	the	_	_	
1-18	112-118	number	_	_	
1-19	119-121	of	_	_	
1-20	122-126	data	_	_	
1-21	127-134	packets	_	_	
1-22	135-138	and	_	_	
1-23	138-139	/	_	_	
1-24	139-141	or	_	_	
1-25	142-145	the	_	_	
1-26	146-151	total	_	_	
1-27	152-158	number	_	_	
1-28	159-161	of	_	_	
1-29	162-167	bytes	_	_	
1-30	168-172	that	_	_	
1-31	173-178	match	_	_	
1-32	179-183	each	_	_	
1-33	184-192	filter's	_	_	
1-34	193-201	criteria	_	_	
1-35	201-202	.	_	_	

#Text=As noted earlier, each user-defined filter may be defined using Boolean logic to specify complex filter match criteria which may include ranges and/or disjoint lists of values, resulting in an implementation that requires many filter engine rules, each rule generating its own statistics.
2-1	203-205	As	_	_	
2-2	206-211	noted	_	_	
2-3	212-219	earlier	_	_	
2-4	219-220	,	_	_	
2-5	221-225	each	_	_	
2-6	226-238	user-defined	_	_	
2-7	239-245	filter	_	_	
2-8	246-249	may	_	_	
2-9	250-252	be	_	_	
2-10	253-260	defined	_	_	
2-11	261-266	using	_	_	
2-12	267-274	Boolean	_	_	
2-13	275-280	logic	_	_	
2-14	281-283	to	_	_	
2-15	284-291	specify	_	_	
2-16	292-299	complex	_	_	
2-17	300-306	filter	_	_	
2-18	307-312	match	_	_	
2-19	313-321	criteria	_	_	
2-20	322-327	which	_	_	
2-21	328-331	may	_	_	
2-22	332-339	include	_	_	
2-23	340-346	ranges	_	_	
2-24	347-350	and	_	_	
2-25	350-351	/	_	_	
2-26	351-353	or	_	_	
2-27	354-362	disjoint	_	_	
2-28	363-368	lists	_	_	
2-29	369-371	of	_	_	
2-30	372-378	values	_	_	
2-31	378-379	,	_	_	
2-32	380-389	resulting	_	_	
2-33	390-392	in	_	_	
2-34	393-395	an	_	_	
2-35	396-410	implementation	_	_	
2-36	411-415	that	_	_	
2-37	416-424	requires	_	_	
2-38	425-429	many	_	_	
2-39	430-436	filter	_	_	
2-40	437-443	engine	_	_	
2-41	444-449	rules	_	_	
2-42	449-450	,	_	_	
2-43	451-455	each	_	_	
2-44	456-460	rule	_	_	
2-45	461-471	generating	_	_	
2-46	472-475	its	_	_	
2-47	476-479	own	_	_	
2-48	480-490	statistics	_	_	
2-49	490-491	.	_	_	

#Text=As part of the processing described herein, rule statistics can be automatically aggregated from all of the underlying filter rule match counts in order to present meaningful filter statistics to the user.
3-1	492-494	As	_	_	
3-2	495-499	part	_	_	
3-3	500-502	of	_	_	
3-4	503-506	the	_	_	
3-5	507-517	processing	_	_	
3-6	518-527	described	_	_	
3-7	528-534	herein	_	_	
3-8	534-535	,	_	_	
3-9	536-540	rule	_	_	
3-10	541-551	statistics	_	_	
3-11	552-555	can	_	_	
3-12	556-558	be	_	_	
3-13	559-572	automatically	_	_	
3-14	573-583	aggregated	_	_	
3-15	584-588	from	_	_	
3-16	589-592	all	_	_	
3-17	593-595	of	_	_	
3-18	596-599	the	_	_	
3-19	600-610	underlying	_	_	
3-20	611-617	filter	_	_	
3-21	618-622	rule	_	_	
3-22	623-628	match	_	_	
3-23	629-635	counts	_	_	
3-24	636-638	in	_	_	
3-25	639-644	order	_	_	
3-26	645-647	to	_	_	
3-27	648-655	present	_	_	
3-28	656-666	meaningful	_	_	
3-29	667-673	filter	_	_	
3-30	674-684	statistics	_	_	
3-31	685-687	to	_	_	
3-32	688-691	the	_	_	
3-33	692-696	user	_	_	
3-34	696-697	.	_	_	

#Text=One further problem that can occur with overlapping filters, however, is that these match statistics can be inaccurate.
4-1	698-701	One	*[1]	6-5[2_1]	
4-2	702-709	further	*[1]	_	
4-3	710-717	problem	*[1]	_	
4-4	718-722	that	*[1]	_	
4-5	723-726	can	*[1]	_	
4-6	727-732	occur	*[1]	_	
4-7	733-737	with	*[1]	_	
4-8	738-749	overlapping	*[1]	_	
4-9	750-757	filters	*[1]	_	
4-10	757-758	,	*[1]	_	
4-11	759-766	however	*[1]	_	
4-12	766-767	,	*[1]	_	
4-13	768-770	is	*[1]	_	
4-14	771-775	that	*[1]	_	
4-15	776-781	these	*[1]	_	
4-16	782-787	match	*[1]	_	
4-17	788-798	statistics	*[1]	_	
4-18	799-802	can	*[1]	_	
4-19	803-805	be	*[1]	_	
4-20	806-816	inaccurate	*[1]	_	
4-21	816-817	.	*[1]	_	

#Text=For example, looking at FIG. 9A, if rules for each filter are located in the same ingress filter engine and rules 902 and 904 have higher priority, statistics associated with rule 906 that forwards TCP packets would likely be inaccurate because rule 906 does not receive any packets associated with VLAN 1-6.
5-1	818-821	For	_	_	
5-2	822-829	example	_	_	
5-3	829-830	,	_	_	
5-4	831-838	looking	_	_	
5-5	839-841	at	_	_	
5-6	842-845	FIG	_	_	
5-7	845-846	.	_	_	
5-8	847-849	9A	_	_	
5-9	849-850	,	_	_	
5-10	851-853	if	_	_	
5-11	854-859	rules	_	_	
5-12	860-863	for	_	_	
5-13	864-868	each	_	_	
5-14	869-875	filter	_	_	
5-15	876-879	are	_	_	
5-16	880-887	located	_	_	
5-17	888-890	in	_	_	
5-18	891-894	the	_	_	
5-19	895-899	same	_	_	
5-20	900-907	ingress	_	_	
5-21	908-914	filter	_	_	
5-22	915-921	engine	_	_	
5-23	922-925	and	_	_	
5-24	926-931	rules	_	_	
5-25	932-935	902	_	_	
5-26	936-939	and	_	_	
5-27	940-943	904	_	_	
5-28	944-948	have	_	_	
5-29	949-955	higher	_	_	
5-30	956-964	priority	_	_	
5-31	964-965	,	_	_	
5-32	966-976	statistics	_	_	
5-33	977-987	associated	_	_	
5-34	988-992	with	_	_	
5-35	993-997	rule	_	_	
5-36	998-1001	906	_	_	
5-37	1002-1006	that	_	_	
5-38	1007-1015	forwards	_	_	
5-39	1016-1019	TCP	_	_	
5-40	1020-1027	packets	_	_	
5-41	1028-1033	would	_	_	
5-42	1034-1040	likely	_	_	
5-43	1041-1043	be	_	_	
5-44	1044-1054	inaccurate	_	_	
5-45	1055-1062	because	_	_	
5-46	1063-1067	rule	_	_	
5-47	1068-1071	906	_	_	
5-48	1072-1076	does	_	_	
5-49	1077-1080	not	_	_	
5-50	1081-1088	receive	_	_	
5-51	1089-1092	any	_	_	
5-52	1093-1100	packets	_	_	
5-53	1101-1111	associated	_	_	
5-54	1112-1116	with	_	_	
5-55	1117-1121	VLAN	_	_	
5-56	1122-1123	1	_	_	
5-57	1123-1124	-	_	_	
5-58	1124-1125	6	_	_	
5-59	1125-1126	.	_	_	

#Text=As described herein, this problem with inaccurate statistics caused by filter overlaps can be resolved by taking advantage of multiple different ingress filter engines that are available in packet switch integrated circuits.
6-1	1127-1129	As	_	_	
6-2	1130-1139	described	_	_	
6-3	1140-1146	herein	_	_	
6-4	1146-1147	,	_	_	
6-5	1148-1152	this	*[2]	_	
6-6	1153-1160	problem	*[2]	_	
6-7	1161-1165	with	_	_	
6-8	1166-1176	inaccurate	_	_	
6-9	1177-1187	statistics	_	_	
6-10	1188-1194	caused	_	_	
6-11	1195-1197	by	_	_	
6-12	1198-1204	filter	_	_	
6-13	1205-1213	overlaps	_	_	
6-14	1214-1217	can	_	_	
6-15	1218-1220	be	_	_	
6-16	1221-1229	resolved	_	_	
6-17	1230-1232	by	_	_	
6-18	1233-1239	taking	_	_	
6-19	1240-1249	advantage	_	_	
6-20	1250-1252	of	_	_	
6-21	1253-1261	multiple	_	_	
6-22	1262-1271	different	_	_	
6-23	1272-1279	ingress	_	_	
6-24	1280-1286	filter	_	_	
6-25	1287-1294	engines	_	_	
6-26	1295-1299	that	_	_	
6-27	1300-1303	are	_	_	
6-28	1304-1313	available	_	_	
6-29	1314-1316	in	_	_	
6-30	1317-1323	packet	_	_	
6-31	1324-1330	switch	_	_	
6-32	1331-1341	integrated	_	_	
6-33	1342-1350	circuits	_	_	
6-34	1350-1351	.	_	_	

#Text=Each engine "matches" independently of the other parallel engines and maintains its own match statistics.
7-1	1352-1356	Each	_	_	
7-2	1357-1363	engine	_	_	
7-3	1364-1365	"	_	_	
7-4	1365-1372	matches	_	_	
7-5	1372-1373	"	_	_	
7-6	1374-1387	independently	_	_	
7-7	1388-1390	of	_	_	
7-8	1391-1394	the	_	_	
7-9	1395-1400	other	_	_	
7-10	1401-1409	parallel	_	_	
7-11	1410-1417	engines	_	_	
7-12	1418-1421	and	_	_	
7-13	1422-1431	maintains	_	_	
7-14	1432-1435	its	_	_	
7-15	1436-1439	own	_	_	
7-16	1440-1445	match	_	_	
7-17	1446-1456	statistics	_	_	
7-18	1456-1457	.	_	_	

#Text=When multiple parallel TCAM matching engines are available for ingress filtering, this parallelism can be used to help ensure that packet match statistics (e.g., byte and/or packet counts) are not corrupted by rule overlaps.
8-1	1458-1462	When	_	_	
8-2	1463-1471	multiple	_	_	
8-3	1472-1480	parallel	_	_	
8-4	1481-1485	TCAM	_	_	
8-5	1486-1494	matching	_	_	
8-6	1495-1502	engines	_	_	
8-7	1503-1506	are	_	_	
8-8	1507-1516	available	_	_	
8-9	1517-1520	for	_	_	
8-10	1521-1528	ingress	_	_	
8-11	1529-1538	filtering	_	_	
8-12	1538-1539	,	_	_	
8-13	1540-1544	this	_	_	
8-14	1545-1556	parallelism	_	_	
8-15	1557-1560	can	_	_	
8-16	1561-1563	be	_	_	
8-17	1564-1568	used	_	_	
8-18	1569-1571	to	_	_	
8-19	1572-1576	help	_	_	
8-20	1577-1583	ensure	_	_	
8-21	1584-1588	that	_	_	
8-22	1589-1595	packet	_	_	
8-23	1596-1601	match	_	_	
8-24	1602-1612	statistics	_	_	
8-25	1613-1614	(	_	_	
8-26	1614-1617	e.g	_	_	
8-27	1617-1618	.	_	_	
8-28	1618-1619	,	_	_	
8-29	1620-1624	byte	_	_	
8-30	1625-1628	and	_	_	
8-31	1628-1629	/	_	_	
8-32	1629-1631	or	_	_	
8-33	1632-1638	packet	_	_	
8-34	1639-1645	counts	_	_	
8-35	1645-1646	)	_	_	
8-36	1647-1650	are	_	_	
8-37	1651-1654	not	_	_	
8-38	1655-1664	corrupted	_	_	
8-39	1665-1667	by	_	_	
8-40	1668-1672	rule	_	_	
8-41	1673-1681	overlaps	_	_	
8-42	1681-1682	.	_	_	

#Text=In particular, filter rules for a user-defined filter are provisioned into an ingress engine that does not contain filter rules for an overlapping filter, available space permitting.
9-1	1683-1685	In	_	_	
9-2	1686-1696	particular	_	_	
9-3	1696-1697	,	_	_	
9-4	1698-1704	filter	_	_	
9-5	1705-1710	rules	_	_	
9-6	1711-1714	for	_	_	
9-7	1715-1716	a	_	_	
9-8	1717-1729	user-defined	_	_	
9-9	1730-1736	filter	_	_	
9-10	1737-1740	are	_	_	
9-11	1741-1752	provisioned	_	_	
9-12	1753-1757	into	_	_	
9-13	1758-1760	an	_	_	
9-14	1761-1768	ingress	_	_	
9-15	1769-1775	engine	_	_	
9-16	1776-1780	that	_	_	
9-17	1781-1785	does	_	_	
9-18	1786-1789	not	_	_	
9-19	1790-1797	contain	_	_	
9-20	1798-1804	filter	_	_	
9-21	1805-1810	rules	_	_	
9-22	1811-1814	for	_	_	
9-23	1815-1817	an	_	_	
9-24	1818-1829	overlapping	_	_	
9-25	1830-1836	filter	_	_	
9-26	1836-1837	,	_	_	
9-27	1838-1847	available	_	_	
9-28	1848-1853	space	_	_	
9-29	1854-1864	permitting	_	_	
9-30	1864-1865	.	_	_	

#Text=Space will be available as long as the maximum number of filter overlaps for any filter is less than the number of parallel ingress TCAM engines, and there is enough available space to provision the filter in at least one engine that does not contain an overlapping rule.
10-1	1866-1871	Space	_	_	
10-2	1872-1876	will	_	_	
10-3	1877-1879	be	_	_	
10-4	1880-1889	available	_	_	
10-5	1890-1892	as	_	_	
10-6	1893-1897	long	_	_	
10-7	1898-1900	as	_	_	
10-8	1901-1904	the	_	_	
10-9	1905-1912	maximum	_	_	
10-10	1913-1919	number	_	_	
10-11	1920-1922	of	_	_	
10-12	1923-1929	filter	_	_	
10-13	1930-1938	overlaps	_	_	
10-14	1939-1942	for	_	_	
10-15	1943-1946	any	_	_	
10-16	1947-1953	filter	_	_	
10-17	1954-1956	is	_	_	
10-18	1957-1961	less	_	_	
10-19	1962-1966	than	_	_	
10-20	1967-1970	the	_	_	
10-21	1971-1977	number	_	_	
10-22	1978-1980	of	_	_	
10-23	1981-1989	parallel	_	_	
10-24	1990-1997	ingress	_	_	
10-25	1998-2002	TCAM	_	_	
10-26	2003-2010	engines	_	_	
10-27	2010-2011	,	_	_	
10-28	2012-2015	and	_	_	
10-29	2016-2021	there	_	_	
10-30	2022-2024	is	_	_	
10-31	2025-2031	enough	_	_	
10-32	2032-2041	available	_	_	
10-33	2042-2047	space	_	_	
10-34	2048-2050	to	_	_	
10-35	2051-2060	provision	_	_	
10-36	2061-2064	the	_	_	
10-37	2065-2071	filter	_	_	
10-38	2072-2074	in	_	_	
10-39	2075-2077	at	_	_	
10-40	2078-2083	least	_	_	
10-41	2084-2087	one	_	_	
10-42	2088-2094	engine	_	_	
10-43	2095-2099	that	_	_	
10-44	2100-2104	does	_	_	
10-45	2105-2108	not	_	_	
10-46	2109-2116	contain	_	_	
10-47	2117-2119	an	_	_	
10-48	2120-2131	overlapping	_	_	
10-49	2132-2136	rule	_	_	
10-50	2136-2137	.	_	_	

#Text=As long as no overlapping filter rules are provisioned in the same TCAM engine, the statistics are accurate.
11-1	2138-2140	As	_	_	
11-2	2141-2145	long	_	_	
11-3	2146-2148	as	_	_	
11-4	2149-2151	no	_	_	
11-5	2152-2163	overlapping	_	_	
11-6	2164-2170	filter	_	_	
11-7	2171-2176	rules	_	_	
11-8	2177-2180	are	_	_	
11-9	2181-2192	provisioned	_	_	
11-10	2193-2195	in	_	_	
11-11	2196-2199	the	_	_	
11-12	2200-2204	same	_	_	
11-13	2205-2209	TCAM	_	_	
11-14	2210-2216	engine	_	_	
11-15	2216-2217	,	_	_	
11-16	2218-2221	the	_	_	
11-17	2222-2232	statistics	_	_	
11-18	2233-2236	are	_	_	
11-19	2237-2245	accurate	_	_	
11-20	2245-2246	.	_	_	

#Text=This ability to provide accurate filter statistics and do so through automatic generation of filter rules and automatic application of those filter rules to appropriate ingress filter engines, even if there are overlapping user-defined filters and filter rules, is a significant advantage that is not provided by prior systems.
12-1	2247-2251	This	_	_	
12-2	2252-2259	ability	_	_	
12-3	2260-2262	to	_	_	
12-4	2263-2270	provide	_	_	
12-5	2271-2279	accurate	_	_	
12-6	2280-2286	filter	_	_	
12-7	2287-2297	statistics	_	_	
12-8	2298-2301	and	_	_	
12-9	2302-2304	do	_	_	
12-10	2305-2307	so	_	_	
12-11	2308-2315	through	_	_	
12-12	2316-2325	automatic	_	_	
12-13	2326-2336	generation	_	_	
12-14	2337-2339	of	_	_	
12-15	2340-2346	filter	_	_	
12-16	2347-2352	rules	_	_	
12-17	2353-2356	and	_	_	
12-18	2357-2366	automatic	_	_	
12-19	2367-2378	application	_	_	
12-20	2379-2381	of	_	_	
12-21	2382-2387	those	_	_	
12-22	2388-2394	filter	_	_	
12-23	2395-2400	rules	_	_	
12-24	2401-2403	to	_	_	
12-25	2404-2415	appropriate	_	_	
12-26	2416-2423	ingress	_	_	
12-27	2424-2430	filter	_	_	
12-28	2431-2438	engines	_	_	
12-29	2438-2439	,	_	_	
12-30	2440-2444	even	_	_	
12-31	2445-2447	if	_	_	
12-32	2448-2453	there	_	_	
12-33	2454-2457	are	_	_	
12-34	2458-2469	overlapping	_	_	
12-35	2470-2482	user-defined	_	_	
12-36	2483-2490	filters	_	_	
12-37	2491-2494	and	_	_	
12-38	2495-2501	filter	_	_	
12-39	2502-2507	rules	_	_	
12-40	2507-2508	,	_	_	
12-41	2509-2511	is	_	_	
12-42	2512-2513	a	_	_	
12-43	2514-2525	significant	_	_	
12-44	2526-2535	advantage	_	_	
12-45	2536-2540	that	_	_	
12-46	2541-2543	is	_	_	
12-47	2544-2547	not	_	_	
12-48	2548-2556	provided	_	_	
12-49	2557-2559	by	_	_	
12-50	2560-2565	prior	_	_	
12-51	2566-2573	systems	_	_	
12-52	2573-2574	.	_	_	

#Text=FIG. 10A is a block diagram of an embodiment 1000 for using multiple parallel ingress filter engines 1001 and an action resolution engine 1012 to implement the ingress filter engines 206 and provide accurate statistics.
13-1	2575-2578	FIG	_	_	
13-2	2578-2579	.	_	_	
13-3	2580-2583	10A	_	_	
13-4	2584-2586	is	_	_	
13-5	2587-2588	a	_	_	
13-6	2589-2594	block	_	_	
13-7	2595-2602	diagram	_	_	
13-8	2603-2605	of	_	_	
13-9	2606-2608	an	_	_	
13-10	2609-2619	embodiment	_	_	
13-11	2620-2624	1000	_	_	
13-12	2625-2628	for	_	_	
13-13	2629-2634	using	_	_	
13-14	2635-2643	multiple	_	_	
13-15	2644-2652	parallel	_	_	
13-16	2653-2660	ingress	_	_	
13-17	2661-2667	filter	_	_	
13-18	2668-2675	engines	_	_	
13-19	2676-2680	1001	_	_	
13-20	2681-2684	and	_	_	
13-21	2685-2687	an	_	_	
13-22	2688-2694	action	_	_	
13-23	2695-2705	resolution	_	_	
13-24	2706-2712	engine	_	_	
13-25	2713-2717	1012	_	_	
13-26	2718-2720	to	_	_	
13-27	2721-2730	implement	_	_	
13-28	2731-2734	the	_	_	
13-29	2735-2742	ingress	_	_	
13-30	2743-2749	filter	_	_	
13-31	2750-2757	engines	_	_	
13-32	2758-2761	206	_	_	
13-33	2762-2765	and	_	_	
13-34	2766-2773	provide	_	_	
13-35	2774-2782	accurate	_	_	
13-36	2783-2793	statistics	_	_	
13-37	2793-2794	.	_	_	

#Text=As depicted, 1002, 1004 . . . 1006 each include non-overlapping internal filters rules in order to maintain accurate filter statistics for the tool optimizer 102 as described herein.
14-1	2795-2797	As	_	_	
14-2	2798-2806	depicted	_	_	
14-3	2806-2807	,	_	_	
14-4	2808-2812	1002	_	_	
14-5	2812-2813	,	_	_	
14-6	2814-2818	1004	_	_	
14-7	2819-2820	.	_	_	
14-8	2821-2822	.	_	_	
14-9	2823-2824	.	_	_	
14-10	2825-2829	1006	_	_	
14-11	2830-2834	each	_	_	
14-12	2835-2842	include	_	_	
14-13	2843-2858	non-overlapping	_	_	
14-14	2859-2867	internal	_	_	
14-15	2868-2875	filters	_	_	
14-16	2876-2881	rules	_	_	
14-17	2882-2884	in	_	_	
14-18	2885-2890	order	_	_	
14-19	2891-2893	to	_	_	
14-20	2894-2902	maintain	_	_	
14-21	2903-2911	accurate	_	_	
14-22	2912-2918	filter	_	_	
14-23	2919-2929	statistics	_	_	
14-24	2930-2933	for	_	_	
14-25	2934-2937	the	_	_	
14-26	2938-2942	tool	_	_	
14-27	2943-2952	optimizer	_	_	
14-28	2953-2956	102	_	_	
14-29	2957-2959	as	_	_	
14-30	2960-2969	described	_	_	
14-31	2970-2976	herein	_	_	
14-32	2976-2977	.	_	_	

#Text=As depicted, ingress filter engines 206 include multiple different ingress filter engines (ENGINE 0) 1002, (ENGINE 1) 1004 . . .
15-1	2978-2980	As	_	_	
15-2	2981-2989	depicted	_	_	
15-3	2989-2990	,	_	_	
15-4	2991-2998	ingress	_	_	
15-5	2999-3005	filter	_	_	
15-6	3006-3013	engines	_	_	
15-7	3014-3017	206	_	_	
15-8	3018-3025	include	_	_	
15-9	3026-3034	multiple	_	_	
15-10	3035-3044	different	_	_	
15-11	3045-3052	ingress	_	_	
15-12	3053-3059	filter	_	_	
15-13	3060-3067	engines	_	_	
15-14	3068-3069	(	_	_	
15-15	3069-3075	ENGINE	_	_	
15-16	3076-3077	0	_	_	
15-17	3077-3078	)	_	_	
15-18	3079-3083	1002	_	_	
15-19	3083-3084	,	_	_	
15-20	3085-3086	(	_	_	
15-21	3086-3092	ENGINE	_	_	
15-22	3093-3094	1	_	_	
15-23	3094-3095	)	_	_	
15-24	3096-3100	1004	_	_	
15-25	3101-3102	.	_	_	
15-26	3103-3104	.	_	_	
15-27	3105-3106	.	_	_	

#Text=(ENGINE (n)) 1006 that each provide actions such as "FORWARD" or `DROP` to the action resolution engine 1012.
16-1	3107-3108	(	_	_	
16-2	3108-3114	ENGINE	_	_	
16-3	3115-3116	(	_	_	
16-4	3116-3117	n	_	_	
16-5	3117-3118	)	_	_	
16-6	3118-3119	)	_	_	
16-7	3120-3124	1006	_	_	
16-8	3125-3129	that	_	_	
16-9	3130-3134	each	_	_	
16-10	3135-3142	provide	_	_	
16-11	3143-3150	actions	_	_	
16-12	3151-3155	such	_	_	
16-13	3156-3158	as	_	_	
16-14	3159-3160	"	_	_	
16-15	3160-3167	FORWARD	_	_	
16-16	3167-3168	"	_	_	
16-17	3169-3171	or	_	_	
16-18	3172-3173	`	_	_	
16-19	3173-3177	DROP	_	_	
16-20	3177-3178	`	_	_	
16-21	3179-3181	to	_	_	
16-22	3182-3185	the	_	_	
16-23	3186-3192	action	_	_	
16-24	3193-3203	resolution	_	_	
16-25	3204-3210	engine	_	_	
16-26	3211-3215	1012	_	_	
16-27	3215-3216	.	_	_	

#Text=As described above, the action resolution engine 1012 for current network switch ICs will provide a single forwarding action for any given packet based upon priority, and this forwarding action will be provided to the packet forwarding circuitry.
17-1	3217-3219	As	_	_	
17-2	3220-3229	described	_	_	
17-3	3230-3235	above	_	_	
17-4	3235-3236	,	_	_	
17-5	3237-3240	the	_	_	
17-6	3241-3247	action	_	_	
17-7	3248-3258	resolution	_	_	
17-8	3259-3265	engine	_	_	
17-9	3266-3270	1012	_	_	
17-10	3271-3274	for	_	_	
17-11	3275-3282	current	_	_	
17-12	3283-3290	network	_	_	
17-13	3291-3297	switch	_	_	
17-14	3298-3301	ICs	_	_	
17-15	3302-3306	will	_	_	
17-16	3307-3314	provide	_	_	
17-17	3315-3316	a	_	_	
17-18	3317-3323	single	_	_	
17-19	3324-3334	forwarding	_	_	
17-20	3335-3341	action	_	_	
17-21	3342-3345	for	_	_	
17-22	3346-3349	any	_	_	
17-23	3350-3355	given	_	_	
17-24	3356-3362	packet	_	_	
17-25	3363-3368	based	_	_	
17-26	3369-3373	upon	_	_	
17-27	3374-3382	priority	_	_	
17-28	3382-3383	,	_	_	
17-29	3384-3387	and	_	_	
17-30	3388-3392	this	_	_	
17-31	3393-3403	forwarding	_	_	
17-32	3404-3410	action	_	_	
17-33	3411-3415	will	_	_	
17-34	3416-3418	be	_	_	
17-35	3419-3427	provided	_	_	
17-36	3428-3430	to	_	_	
17-37	3431-3434	the	_	_	
17-38	3435-3441	packet	_	_	
17-39	3442-3452	forwarding	_	_	
17-40	3453-3462	circuitry	_	_	
17-41	3462-3463	.	_	_	

#Text=The multiple different ingress filter engines (ENGINE 0) 1002, (ENGINE 1) 1004 . . .
18-1	3464-3467	The	_	_	
18-2	3468-3476	multiple	_	_	
18-3	3477-3486	different	_	_	
18-4	3487-3494	ingress	_	_	
18-5	3495-3501	filter	_	_	
18-6	3502-3509	engines	_	_	
18-7	3510-3511	(	_	_	
18-8	3511-3517	ENGINE	_	_	
18-9	3518-3519	0	_	_	
18-10	3519-3520	)	_	_	
18-11	3521-3525	1002	_	_	
18-12	3525-3526	,	_	_	
18-13	3527-3528	(	_	_	
18-14	3528-3534	ENGINE	_	_	
18-15	3535-3536	1	_	_	
18-16	3536-3537	)	_	_	
18-17	3538-3542	1004	_	_	
18-18	3543-3544	.	_	_	
18-19	3545-3546	.	_	_	
18-20	3547-3548	.	_	_	

#Text=(ENGINE (n)) 1006 also provide statistics to the statistics engine 1010.
19-1	3549-3550	(	_	_	
19-2	3550-3556	ENGINE	_	_	
19-3	3557-3558	(	_	_	
19-4	3558-3559	n	_	_	
19-5	3559-3560	)	_	_	
19-6	3560-3561	)	_	_	
19-7	3562-3566	1006	_	_	
19-8	3567-3571	also	_	_	
19-9	3572-3579	provide	_	_	
19-10	3580-3590	statistics	_	_	
19-11	3591-3593	to	_	_	
19-12	3594-3597	the	_	_	
19-13	3598-3608	statistics	_	_	
19-14	3609-3615	engine	_	_	
19-15	3616-3620	1010	_	_	
19-16	3620-3621	.	_	_	

#Text=In operation, source 702 provides packets to each of the different ingress filter engines (ENGINE 0) 1002, (ENGINE 1) 1004 . . .
20-1	3622-3624	In	_	_	
20-2	3625-3634	operation	_	_	
20-3	3634-3635	,	_	_	
20-4	3636-3642	source	_	_	
20-5	3643-3646	702	_	_	
20-6	3647-3655	provides	_	_	
20-7	3656-3663	packets	_	_	
20-8	3664-3666	to	_	_	
20-9	3667-3671	each	_	_	
20-10	3672-3674	of	_	_	
20-11	3675-3678	the	_	_	
20-12	3679-3688	different	_	_	
20-13	3689-3696	ingress	_	_	
20-14	3697-3703	filter	_	_	
20-15	3704-3711	engines	_	_	
20-16	3712-3713	(	_	_	
20-17	3713-3719	ENGINE	_	_	
20-18	3720-3721	0	_	_	
20-19	3721-3722	)	_	_	
20-20	3723-3727	1002	_	_	
20-21	3727-3728	,	_	_	
20-22	3729-3730	(	_	_	
20-23	3730-3736	ENGINE	_	_	
20-24	3737-3738	1	_	_	
20-25	3738-3739	)	_	_	
20-26	3740-3744	1004	_	_	
20-27	3745-3746	.	_	_	
20-28	3747-3748	.	_	_	
20-29	3749-3750	.	_	_	

#Text=(ENGINE (n)) 1006.
21-1	3751-3752	(	_	_	
21-2	3752-3758	ENGINE	_	_	
21-3	3759-3760	(	_	_	
21-4	3760-3761	n	_	_	
21-5	3761-3762	)	_	_	
21-6	3762-3763	)	_	_	
21-7	3764-3768	1006	_	_	
21-8	3768-3769	.	_	_	

#Text=As described above, the different ingress filters will be processed according to their priority with ENGINE 0 1002 being processed last as indicated by line 1003.
22-1	3770-3772	As	_	_	
22-2	3773-3782	described	_	_	
22-3	3783-3788	above	_	_	
22-4	3788-3789	,	_	_	
22-5	3790-3793	the	_	_	
22-6	3794-3803	different	_	_	
22-7	3804-3811	ingress	_	_	
22-8	3812-3819	filters	_	_	
22-9	3820-3824	will	_	_	
22-10	3825-3827	be	_	_	
22-11	3828-3837	processed	_	_	
22-12	3838-3847	according	_	_	
22-13	3848-3850	to	_	_	
22-14	3851-3856	their	_	_	
22-15	3857-3865	priority	_	_	
22-16	3866-3870	with	_	_	
22-17	3871-3877	ENGINE	_	_	
22-18	3878-3879	0	_	_	
22-19	3880-3884	1002	_	_	
22-20	3885-3890	being	_	_	
22-21	3891-3900	processed	_	_	
22-22	3901-3905	last	_	_	
22-23	3906-3908	as	_	_	
22-24	3909-3918	indicated	_	_	
22-25	3919-3921	by	_	_	
22-26	3922-3926	line	_	_	
22-27	3927-3931	1003	_	_	
22-28	3931-3932	.	_	_	

#Text=Advantageously, the dynamic filter processor described herein allocates rules to each filter engine such that no overlapping rules are contained in a single engine.
23-1	3933-3947	Advantageously	_	_	
23-2	3947-3948	,	_	_	
23-3	3949-3952	the	_	_	
23-4	3953-3960	dynamic	_	_	
23-5	3961-3967	filter	_	_	
23-6	3968-3977	processor	_	_	
23-7	3978-3987	described	_	_	
23-8	3988-3994	herein	_	_	
23-9	3995-4004	allocates	_	_	
23-10	4005-4010	rules	_	_	
23-11	4011-4013	to	_	_	
23-12	4014-4018	each	_	_	
23-13	4019-4025	filter	_	_	
23-14	4026-4032	engine	_	_	
23-15	4033-4037	such	_	_	
23-16	4038-4042	that	_	_	
23-17	4043-4045	no	_	_	
23-18	4046-4057	overlapping	_	_	
23-19	4058-4063	rules	_	_	
23-20	4064-4067	are	_	_	
23-21	4068-4077	contained	_	_	
23-22	4078-4080	in	_	_	
23-23	4081-4082	a	_	_	
23-24	4083-4089	single	_	_	
23-25	4090-4096	engine	_	_	
23-26	4096-4097	.	_	_	

#Text=Because each engine receives the data packets from source 702 and each engine does not include overlapping rules, the statistics data output by the different ingress filter engines (ENGINE 0) 1002, (ENGINE 1) 1004 . . .
24-1	4098-4105	Because	_	_	
24-2	4106-4110	each	_	_	
24-3	4111-4117	engine	_	_	
24-4	4118-4126	receives	_	_	
24-5	4127-4130	the	_	_	
24-6	4131-4135	data	_	_	
24-7	4136-4143	packets	_	_	
24-8	4144-4148	from	_	_	
24-9	4149-4155	source	_	_	
24-10	4156-4159	702	_	_	
24-11	4160-4163	and	_	_	
24-12	4164-4168	each	_	_	
24-13	4169-4175	engine	_	_	
24-14	4176-4180	does	_	_	
24-15	4181-4184	not	_	_	
24-16	4185-4192	include	_	_	
24-17	4193-4204	overlapping	_	_	
24-18	4205-4210	rules	_	_	
24-19	4210-4211	,	_	_	
24-20	4212-4215	the	_	_	
24-21	4216-4226	statistics	_	_	
24-22	4227-4231	data	_	_	
24-23	4232-4238	output	_	_	
24-24	4239-4241	by	_	_	
24-25	4242-4245	the	_	_	
24-26	4246-4255	different	_	_	
24-27	4256-4263	ingress	_	_	
24-28	4264-4270	filter	_	_	
24-29	4271-4278	engines	_	_	
24-30	4279-4280	(	_	_	
24-31	4280-4286	ENGINE	_	_	
24-32	4287-4288	0	_	_	
24-33	4288-4289	)	_	_	
24-34	4290-4294	1002	_	_	
24-35	4294-4295	,	_	_	
24-36	4296-4297	(	_	_	
24-37	4297-4303	ENGINE	_	_	
24-38	4304-4305	1	_	_	
24-39	4305-4306	)	_	_	
24-40	4307-4311	1004	_	_	
24-41	4312-4313	.	_	_	
24-42	4314-4315	.	_	_	
24-43	4316-4317	.	_	_	

#Text=(ENGINE (n)) 1006 to the statistics engine 1010 do not suffer from the problem of mis-reported packet matches.
25-1	4318-4319	(	_	_	
25-2	4319-4325	ENGINE	_	_	
25-3	4326-4327	(	_	_	
25-4	4327-4328	n	_	_	
25-5	4328-4329	)	_	_	
25-6	4329-4330	)	_	_	
25-7	4331-4335	1006	_	_	
25-8	4336-4338	to	_	_	
25-9	4339-4342	the	_	_	
25-10	4343-4353	statistics	_	_	
25-11	4354-4360	engine	_	_	
25-12	4361-4365	1010	_	_	
25-13	4366-4368	do	_	_	
25-14	4369-4372	not	_	_	
25-15	4373-4379	suffer	_	_	
25-16	4380-4384	from	_	_	
25-17	4385-4388	the	_	_	
25-18	4389-4396	problem	_	_	
25-19	4397-4399	of	_	_	
25-20	4400-4412	mis-reported	_	_	
25-21	4413-4419	packet	_	_	
25-22	4420-4427	matches	_	_	
25-23	4427-4428	.	_	_	

#Text=In other words, the packets that match each rule within each filter engine will be accurately reported to the statistics engine 1010.
26-1	4429-4431	In	_	_	
26-2	4432-4437	other	_	_	
26-3	4438-4443	words	_	_	
26-4	4443-4444	,	_	_	
26-5	4445-4448	the	_	_	
26-6	4449-4456	packets	_	_	
26-7	4457-4461	that	_	_	
26-8	4462-4467	match	_	_	
26-9	4468-4472	each	_	_	
26-10	4473-4477	rule	_	_	
26-11	4478-4484	within	_	_	
26-12	4485-4489	each	_	_	
26-13	4490-4496	filter	_	_	
26-14	4497-4503	engine	_	_	
26-15	4504-4508	will	_	_	
26-16	4509-4511	be	_	_	
26-17	4512-4522	accurately	_	_	
26-18	4523-4531	reported	_	_	
26-19	4532-4534	to	_	_	
26-20	4535-4538	the	_	_	
26-21	4539-4549	statistics	_	_	
26-22	4550-4556	engine	_	_	
26-23	4557-4561	1010	_	_	
26-24	4561-4562	.	_	_	

#Text=The tool optimizer described herein, therefore, can provide accurate statistics for user defined filters and achieve precision in these statistics that have not achieved by prior solutions.
27-1	4563-4566	The	_	_	
27-2	4567-4571	tool	_	_	
27-3	4572-4581	optimizer	_	_	
27-4	4582-4591	described	_	_	
27-5	4592-4598	herein	_	_	
27-6	4598-4599	,	_	_	
27-7	4600-4609	therefore	_	_	
27-8	4609-4610	,	_	_	
27-9	4611-4614	can	_	_	
27-10	4615-4622	provide	_	_	
27-11	4623-4631	accurate	_	_	
27-12	4632-4642	statistics	_	_	
27-13	4643-4646	for	_	_	
27-14	4647-4651	user	_	_	
27-15	4652-4659	defined	_	_	
27-16	4660-4667	filters	_	_	
27-17	4668-4671	and	_	_	
27-18	4672-4679	achieve	_	_	
27-19	4680-4689	precision	_	_	
27-20	4690-4692	in	_	_	
27-21	4693-4698	these	_	_	
27-22	4699-4709	statistics	_	_	
27-23	4710-4714	that	_	_	
27-24	4715-4719	have	_	_	
27-25	4720-4723	not	_	_	
27-26	4724-4732	achieved	_	_	
27-27	4733-4735	by	_	_	
27-28	4736-4741	prior	_	_	
27-29	4742-4751	solutions	_	_	
27-30	4751-4752	.	_	_	
